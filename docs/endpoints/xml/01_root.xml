<?xml version="1.0" encoding="UTF-8"?>
<endpoint>
  <versions>
    <version level="1.0">
      <name>Get all employers</name>
      <description>Returns a list of valid links indexed by empref in HAL format</description>
      <details>Departmental Access with a Time-based One-Time Password (**TOTP**) in cases where the application needs to track amendments for schemes where the OAuth access token has expired is *NOT* applicable to this endpoint.</details>
      <secured>
        <method>sec.oauth_2_0</method>
        <type>USER</type>
        <scopes>
          <scope>read:apprenticeship-levy</scope>
        </scopes>
      </secured>
      <throttlingTier>Silver</throttlingTier>
      <request>
        <path><![CDATA[/]]></path>
        <params></params>
        <method>GET</method>
        <headers>
          <header>
            <name>Accept</name>
            <value>application/vnd.hmrc.1.0+json</value>
          </header>
          <header>
            <name>Authorization</name>
            <value>Bearer [token here]</value>
          </header>
        </headers>
      </request>
      <responses>
        <http status="200" msg="OK">
          <description>Successful call</description>
          <body>
            <content-type mimeType="application/json"><![CDATA[{
    "_links": {
        "self": {
            "href": "/"
        },
        "123/AB12345": {
            "href": "/epaye/123%2FAB12345"
        }
    },
    "emprefs": [
        "123/AB12345"
    ]
}]]></content-type>
            <description>
              <field>
                <name>_links.self</name>
                <type>URL</type>
                <example><![CDATA[/]]></example>
                <description>The url to this endpoint</description>
              </field>
              <field>
                <name>_links.{empref}</name>
                <type>URL</type>
                <example><![CDATA[/epaye/123%2FAB12345]]></example>
                <description>The url to an endpoint that provides more information about the empref</description>
              </field>
              <field>
                <name>emprefs[]</name>
                <type>String[]</type>
                <example><![CDATA[["123/AB12345"]]]></example>
                <description>A list of emprefs for which links are provided</description>
              </field>
            </description>
          </body>
        </http>
        <http status="401" msg="Unauthorized">
          <description>The request requires correct authentication headers with valid token.</description>
          <body>
            <content-type mimeType="application/json"><![CDATA[{
  "code": "INVALID_CREDENTIALS",
  "message": "Invalid Authentication information provided"
}]]></content-type>
          </body>
          <code>INVALID_CREDENTIALS</code>
        </http>
        <http status="401" msg="Unauthorized">
          <description>The request requires user authentication. Please ensure Grant authority has been given and bearer token is supplied with the request headers.</description>
          <body>
            <content-type mimeType="application/json"><![CDATA[{
  "code": "AUTH_ERROR_UNAUTHORIZED",
  "message": "Auth unauthorised error: GET of 'http://localhost:8080/auth/authority' returned 401. Response body: ''"
}]]></content-type>
          </body>
          <code>AUTH_ERROR_UNAUTHORIZED</code>
        </http>
        <http status="403" msg="Forbidden">
          <description>The request requires user authentication. Please ensure Grant authority has been given and bearer token is supplied with the request headers.</description>
          <body>
            <content-type mimeType="application/json"><![CDATA[{
  "code": "AUTH_ERROR_FORBIDDEN",
  "message": "Auth forbidden error: GET of 'http://localhost:8080/auth/authority' returned 403. Response body: ''"
}]]></content-type>
          </body>
          <code>AUTH_ERROR_FORBIDDEN</code>
        </http>
        <http status="404" msg="Not Found">
          <description>Endpoint or internal system has become unavailable.</description>
          <body>
            <content-type mimeType="application/json"><![CDATA[{
  "code": "AUTH_ERROR_NOT_FOUND",
  "message": "Auth endpoint not found: GET of '....' returned 404 (Not Found). Response body: ''"
}]]></content-type>
          </body>
          <code>AUTH_ERROR_NOT_FOUND</code>
        </http>
        <http status="408" msg="Request Time-out">
          <description>Endpoint or internal system has become unresponsive.</description>
          <body>
            <content-type mimeType="application/json"><![CDATA[{
  "code": "AUTH_ERROR_REQUEST_TIMEOUT",
  "message": "Auth not responding error: GET of '...' timed out with message 'Request timeout to localhost/127.0.0.1:8080 after 500 ms'"
}]]></content-type>
          </body>
          <code>AUTH_ERROR_REQUEST_TIMEOUT</code>
        </http>
        <http status="408" msg="Gateway Request Time-out">
          <description>Endpoint or internal system has become unresponsive.</description>
          <body>
            <content-type mimeType="application/json"><![CDATA[{
  "code": "AUTH_ERROR_GATEWAY_TIMEOUT",
  "message": "Auth not responding error: GET of '...' timed out with message 'Request timeout to localhost/127.0.0.1:8080 after 500 ms'"
}]]></content-type>
          </body>
          <code>AUTH_ERROR_GATEWAY_TIMEOUT</code>
        </http>
        <http status="503" msg="Service Unavailable">
          <description>Endpoint or internal system has experienced an internal error.</description>
          <body>
            <content-type mimeType="application/json"><![CDATA[{
  "code": "AUTH_ERROR_BACKEND_FAILURE",
  "message": "Auth 5xx error: GET of '....' returned 500. Response body: ''"
}]]></content-type>
          </body>
          <code>AUTH_ERROR_BACKEND_FAILURE</code>
        </http>
        <http status="503" msg="Other backend system error with 4xx reponse.">
          <description>Endpoint or internal system has experienced an internal error.</description>
          <body>
            <content-type mimeType="application/json"><![CDATA[{
  "code": "AUTH_ERROR_OTHER",
  "message": "Auth 5xx error: GET of '....' returned 500. Response body: ''"
}]]></content-type>
          </body>
          <code>AUTH_ERROR_OTHER</code>
        </http>
        <http status="498" msg="Wrong token supplied.">
          <description>Endpoint or internal system has experienced an internal error.</description>
          <body>
            <content-type mimeType="application/json"><![CDATA[{
  "code": "AUTH_ERROR_WRONG_TOKEN",
  "message": "Auth unauthorised error: OAUTH 2 User Token Required not TOTP"
}]]></content-type>
          </body>
          <code>AUTH_ERROR_WRONG_TOKEN</code>
        </http>
        <http status="500" msg="Internal API error">
          <description>Endpoint API has experienced an internal error.</description>
          <body>
            <content-type mimeType="application/json"><![CDATA[{
  "code": "AUTH_ERROR_INTERNAL_SERVER_ERROR",
  "message": "API or Auth internal server error: ...."
}]]></content-type>
          </body>
          <code>AUTH_ERROR_INTERNAL_SERVER_ERROR</code>
        </http>
        <http status="409" msg="Internal API error">
          <description>Endpoint API has experienced too many requests.</description>
          <body>
            <content-type mimeType="application/json"><![CDATA[{
  "code": "AUTH_ERROR_TOO_MANY_REQUESTS",
  "message": "Auth too many requests:  ...."
}]]></content-type>
          </body>
          <code>AUTH_ERROR_TOO_MANY_REQUESTS</code>
        </http>
        <http status="503" msg="Backend system IO failure">
          <description>Endpoint API has experienced IO failure</description>
          <body>
            <content-type mimeType="application/json"><![CDATA[{
  "code": "AUTH_ERROR_IO",
  "message": "Auth connection error:  ...."
}]]></content-type>
          </body>
          <code>AUTH_ERROR_IO</code>
        </http>
      </responses>
    </version>
  </versions>
</endpoint>
